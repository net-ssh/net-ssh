<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Net::SSH::Test::Packet - net-ssh 4.2.0</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../";
  var index_rel_prefix = "../../../";
</script>

<script src="../../../js/jquery.js"></script>
<script src="../../../js/darkfish.js"></script>

<link href="../../../css/fonts.css" rel="stylesheet">
<link href="../../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="../Transport/Constants.html">Net::SSH::Transport::Constants</a>
  
  
  
    <li><a class="include" href="../Connection/Constants.html">Net::SSH::Connection::Constants</a>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-c-register_channel_request">::register_channel_request</a>
    
    <li ><a href="#method-c-registered_channel_requests">::registered_channel_requests</a>
    
    <li ><a href="#method-i-instantiate-21">#instantiate!</a>
    
    <li ><a href="#method-i-local-3F">#local?</a>
    
    <li ><a href="#method-i-remote-3F">#remote?</a>
    
    <li ><a href="#method-i-types">#types</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Net::SSH::Test::Packet">
  <h1 id="class-Net::SSH::Test::Packet" class="class">
    class Net::SSH::Test::Packet
  </h1>

  <section class="description">
    
<p>This is an abstract class, not to be instantiated directly, subclassed by
<a href="LocalPacket.html">Net::SSH::Test::LocalPacket</a> and <a
href="RemotePacket.html">Net::SSH::Test::RemotePacket</a>. It implements
functionality common to those subclasses.</p>

<p>These packets are not true packets, in that they don&#39;t represent what
was actually sent between the hosst; rather, they represent what was
expected to be sent, as dictated by the script (Net::SSH::Test::Script).
Thus, though they are defined with data elements, these data elements are
used to either validate data that was sent by the local host
(Net::SSH::Test::LocalPacket) or to mimic the sending of data by the remote
host (Net::SSH::Test::RemotePacket).</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(type, *args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Ceate a new packet of the given <code>type</code>, and with
<code>args</code> being a list of data elements in the order expected for
packets of the given <code>type</code> (see <a
href="Packet.html#method-i-types">types</a>).</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/test/packet.rb, line 34</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">type</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-ivar">@type</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span>)
  <span class="ruby-ivar">@data</span> = <span class="ruby-identifier">args</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-register_channel_request" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">register_channel_request</span><span
            class="method-args">(request, extra_parts)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Register a custom channel request. extra_parts is an array of types of
extra parameters</p>
          
          

          
          <div class="method-source-code" id="register_channel_request-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/test/packet.rb, line 22</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">register_channel_request</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">extra_parts</span>)
  <span class="ruby-ivar">@registered_requests</span> <span class="ruby-operator">||=</span> {}
  <span class="ruby-ivar">@registered_requests</span>[<span class="ruby-identifier">request</span>] = {<span class="ruby-identifier">extra_parts</span><span class="ruby-operator">:</span> <span class="ruby-identifier">extra_parts</span>}
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-registered_channel_requests" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">registered_channel_requests</span><span
            class="method-args">(request)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="registered_channel_requests-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/test/packet.rb, line 27</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">registered_channel_requests</span>(<span class="ruby-identifier">request</span>)
  <span class="ruby-ivar">@registered_requests</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@registered_requests</span>[<span class="ruby-identifier">request</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-instantiate-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">instantiate!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Instantiates the packets data elements. When the packet was first defined,
some elements may not have been fully realized, and were described as Proc
objects rather than atomic types. This invokes those Proc objects and
replaces them with their returned values. This allows for values  like <a
href="Channel.html#method-i-remote_id">Net::SSH::Test::Channel#remote_id</a>
to be used in scripts before the remote_id is known (since it is only known
after a channel has been confirmed open).</p>
          
          

          
          <div class="method-source-code" id="instantiate-21-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/test/packet.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">instantiate!</span>
  <span class="ruby-ivar">@data</span>.<span class="ruby-identifier">map!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:call</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">call</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">i</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-local-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">local?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The default for <code>local?</code> is false. Subclasses should override as
necessary.</p>
          
          

          
          <div class="method-source-code" id="local-3F-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/test/packet.rb, line 45</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">local?</span>
  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remote-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remote?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The default for <code>remote?</code> is false. Subclasses should override
as necessary.</p>
          
          

          
          <div class="method-source-code" id="remote-3F-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/test/packet.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remote?</span>
  <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-types" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">types</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an array of symbols describing the data elements for packets of the
same type as this packet. These types are used to either validate sent
packets (Net::SSH::Test::LocalPacket) or build received packets
(Net::SSH::Test::RemotePacket).</p>

<p>Not all packet types are defined here. As new packet types are required
(e.g., a unit test needs to test that the remote host sent a packet that is
not implemented here), the description of that packet should be added.
Unsupported packet types will otherwise raise an exception.</p>
          
          

          
          <div class="method-source-code" id="types-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/test/packet.rb, line 69</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">types</span>
  <span class="ruby-ivar">@types</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">case</span> <span class="ruby-ivar">@type</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">KEXINIT</span> <span class="ruby-keyword">then</span> 
      [<span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>,
       <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:string</span>,
       <span class="ruby-value">:bool</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-constant">NEWKEYS</span> <span class="ruby-keyword">then</span> []
    <span class="ruby-keyword">when</span> <span class="ruby-constant">CHANNEL_OPEN</span> <span class="ruby-keyword">then</span> [<span class="ruby-value">:string</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-constant">CHANNEL_OPEN_CONFIRMATION</span> <span class="ruby-keyword">then</span> [<span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-constant">CHANNEL_DATA</span> <span class="ruby-keyword">then</span> [<span class="ruby-value">:long</span>, <span class="ruby-value">:string</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-constant">CHANNEL_EXTENDED_DATA</span> <span class="ruby-keyword">then</span> [<span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:string</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-constant">CHANNEL_EOF</span>, <span class="ruby-constant">CHANNEL_CLOSE</span>, <span class="ruby-constant">CHANNEL_SUCCESS</span>, <span class="ruby-constant">CHANNEL_FAILURE</span> <span class="ruby-keyword">then</span> [<span class="ruby-value">:long</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-constant">CHANNEL_REQUEST</span>
      <span class="ruby-identifier">parts</span> = [<span class="ruby-value">:long</span>, <span class="ruby-value">:string</span>, <span class="ruby-value">:bool</span>]
      <span class="ruby-keyword">case</span> <span class="ruby-ivar">@data</span>[<span class="ruby-value">1</span>]
      <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;exec&quot;</span>, <span class="ruby-string">&quot;subsystem&quot;</span>,<span class="ruby-string">&quot;shell&quot;</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">parts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:string</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;exit-status&quot;</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">parts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">:long</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;pty-req&quot;</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">concat</span>([<span class="ruby-value">:string</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:long</span>, <span class="ruby-value">:string</span>])
      <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;env&quot;</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">contact</span>([<span class="ruby-value">:string</span>,<span class="ruby-value">:string</span>])
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">request</span> = <span class="ruby-constant">Packet</span>.<span class="ruby-identifier">registered_channel_requests</span>(<span class="ruby-ivar">@data</span>[<span class="ruby-value">1</span>])
        <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;don&#39;t know what to do about #{@data[1]} channel request&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">request</span>
        <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">request</span>[<span class="ruby-value">:extra_parts</span>])
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;don&#39;t know how to parse packet type #{@type}&quot;</span>
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

