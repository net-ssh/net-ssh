<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

  <title>Class: Net::SSH::Authentication::KeyManager</title>

  <link rel="stylesheet" href="../../../rdoc.css" type="text/css" media="screen" />

  <script src="../../../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../../index.html">Home</a>
          <a href="../../../index.html#classes">Classes</a>
          <a href="../../../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../../../lib/net/ssh/authentication/key_manager_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/net/ssh/authentication/key_manager.rb">lib/net/ssh/authentication/key_manager.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-add">#add</a></li>
          
          <li><a href="#method-i-add_key_data">#add_key_data</a></li>
          
          <li><a href="#method-i-agent">#agent</a></li>
          
          <li><a href="#method-i-clear-21">#clear!</a></li>
          
          <li><a href="#method-i-each_identity">#each_identity</a></li>
          
          <li><a href="#method-i-finish">#finish</a></li>
          
          <li><a href="#method-i-sign">#sign</a></li>
          
          <li><a href="#method-i-use_agent-3D">#use_agent=</a></li>
          
          <li><a href="#method-i-use_agent-3F">#use_agent?</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><a class="include" href="../Loggable.html">Net::SSH::Loggable</a></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../../../CHANGELOG_rdoc.html">CHANGELOG.rdoc</a></li>
        
          <li class="file"><a href="../../../LICENSE_rdoc.html">LICENSE.rdoc</a></li>
        
          <li class="file"><a href="../../../README_rdoc.html">README.rdoc</a></li>
        
          <li class="file"><a href="../../../THANKS_rdoc.html">THANKS.rdoc</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../../../Net.html">Net</a></li>
        
          <li><a href="../../../Net/SSH.html">Net::SSH</a></li>
        
          <li><a href="../../../Net/SSH/Authentication.html">Net::SSH::Authentication</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Agent.html">Net::SSH::Authentication::Agent</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Agent/Comment.html">Net::SSH::Authentication::Agent::Comment</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Agent/Key.html">Net::SSH::Authentication::Agent::Key</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/AgentError.html">Net::SSH::Authentication::AgentError</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/AgentNotAvailable.html">Net::SSH::Authentication::AgentNotAvailable</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Constants.html">Net::SSH::Authentication::Constants</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/DisallowedMethod.html">Net::SSH::Authentication::DisallowedMethod</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/KeyManager.html">Net::SSH::Authentication::KeyManager</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/KeyManagerError.html">Net::SSH::Authentication::KeyManagerError</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Methods.html">Net::SSH::Authentication::Methods</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Methods/Abstract.html">Net::SSH::Authentication::Methods::Abstract</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Methods/Hostbased.html">Net::SSH::Authentication::Methods::Hostbased</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Methods/KeyboardInteractive.html">Net::SSH::Authentication::Methods::KeyboardInteractive</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Methods/Password.html">Net::SSH::Authentication::Methods::Password</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Methods/Publickey.html">Net::SSH::Authentication::Methods::Publickey</a></li>
        
          <li><a href="../../../Net/SSH/Authentication/Session.html">Net::SSH::Authentication::Session</a></li>
        
          <li><a href="../../../Net/SSH/AuthenticationFailed.html">Net::SSH::AuthenticationFailed</a></li>
        
          <li><a href="../../../Net/SSH/Buffer.html">Net::SSH::Buffer</a></li>
        
          <li><a href="../../../Net/SSH/BufferedIo.html">Net::SSH::BufferedIo</a></li>
        
          <li><a href="../../../Net/SSH/ChannelOpenFailed.html">Net::SSH::ChannelOpenFailed</a></li>
        
          <li><a href="../../../Net/SSH/ChannelRequestFailed.html">Net::SSH::ChannelRequestFailed</a></li>
        
          <li><a href="../../../Net/SSH/Compat.html">Net::SSH::Compat</a></li>
        
          <li><a href="../../../Net/SSH/Config.html">Net::SSH::Config</a></li>
        
          <li><a href="../../../Net/SSH/Connection.html">Net::SSH::Connection</a></li>
        
          <li><a href="../../../Net/SSH/Connection/Channel.html">Net::SSH::Connection::Channel</a></li>
        
          <li><a href="../../../Net/SSH/Connection/Constants.html">Net::SSH::Connection::Constants</a></li>
        
          <li><a href="../../../Net/SSH/Connection/Session.html">Net::SSH::Connection::Session</a></li>
        
          <li><a href="../../../Net/SSH/Connection/Session/NilChannel.html">Net::SSH::Connection::Session::NilChannel</a></li>
        
          <li><a href="../../../Net/SSH/Connection/Term.html">Net::SSH::Connection::Term</a></li>
        
          <li><a href="../../../Net/SSH/ConnectionTimeout.html">Net::SSH::ConnectionTimeout</a></li>
        
          <li><a href="../../../Net/SSH/Disconnect.html">Net::SSH::Disconnect</a></li>
        
          <li><a href="../../../Net/SSH/Exception.html">Net::SSH::Exception</a></li>
        
          <li><a href="../../../Net/SSH/ForwardedBufferedIo.html">Net::SSH::ForwardedBufferedIo</a></li>
        
          <li><a href="../../../Net/SSH/HostKeyError.html">Net::SSH::HostKeyError</a></li>
        
          <li><a href="../../../Net/SSH/HostKeyMismatch.html">Net::SSH::HostKeyMismatch</a></li>
        
          <li><a href="../../../Net/SSH/HostKeyUnknown.html">Net::SSH::HostKeyUnknown</a></li>
        
          <li><a href="../../../Net/SSH/KeyFactory.html">Net::SSH::KeyFactory</a></li>
        
          <li><a href="../../../Net/SSH/KnownHosts.html">Net::SSH::KnownHosts</a></li>
        
          <li><a href="../../../Net/SSH/Loggable.html">Net::SSH::Loggable</a></li>
        
          <li><a href="../../../Net/SSH/Packet.html">Net::SSH::Packet</a></li>
        
          <li><a href="../../../Net/SSH/PromptMethods.html">Net::SSH::PromptMethods</a></li>
        
          <li><a href="../../../Net/SSH/PromptMethods/Clear.html">Net::SSH::PromptMethods::Clear</a></li>
        
          <li><a href="../../../Net/SSH/PromptMethods/Highline.html">Net::SSH::PromptMethods::Highline</a></li>
        
          <li><a href="../../../Net/SSH/PromptMethods/Termios.html">Net::SSH::PromptMethods::Termios</a></li>
        
          <li><a href="../../../Net/SSH/Proxy.html">Net::SSH::Proxy</a></li>
        
          <li><a href="../../../Net/SSH/Proxy/Command.html">Net::SSH::Proxy::Command</a></li>
        
          <li><a href="../../../Net/SSH/Proxy/ConnectError.html">Net::SSH::Proxy::ConnectError</a></li>
        
          <li><a href="../../../Net/SSH/Proxy/Error.html">Net::SSH::Proxy::Error</a></li>
        
          <li><a href="../../../Net/SSH/Proxy/HTTP.html">Net::SSH::Proxy::HTTP</a></li>
        
          <li><a href="../../../Net/SSH/Proxy/SOCKS4.html">Net::SSH::Proxy::SOCKS4</a></li>
        
          <li><a href="../../../Net/SSH/Proxy/SOCKS5.html">Net::SSH::Proxy::SOCKS5</a></li>
        
          <li><a href="../../../Net/SSH/Proxy/UnauthorizedError.html">Net::SSH::Proxy::UnauthorizedError</a></li>
        
          <li><a href="../../../Net/SSH/Service.html">Net::SSH::Service</a></li>
        
          <li><a href="../../../Net/SSH/Service/Forward.html">Net::SSH::Service::Forward</a></li>
        
          <li><a href="../../../Net/SSH/Test.html">Net::SSH::Test</a></li>
        
          <li><a href="../../../Net/SSH/Test/Channel.html">Net::SSH::Test::Channel</a></li>
        
          <li><a href="../../../Net/SSH/Test/Extensions.html">Net::SSH::Test::Extensions</a></li>
        
          <li><a href="../../../Net/SSH/Test/Extensions/BufferedIo.html">Net::SSH::Test::Extensions::BufferedIo</a></li>
        
          <li><a href="../../../Net/SSH/Test/Extensions/Channel.html">Net::SSH::Test::Extensions::Channel</a></li>
        
          <li><a href="../../../Net/SSH/Test/Extensions/IO.html">Net::SSH::Test::Extensions::IO</a></li>
        
          <li><a href="../../../Net/SSH/Test/Extensions/IO/ClassMethods.html">Net::SSH::Test::Extensions::IO::ClassMethods</a></li>
        
          <li><a href="../../../Net/SSH/Test/Extensions/PacketStream.html">Net::SSH::Test::Extensions::PacketStream</a></li>
        
          <li><a href="../../../Net/SSH/Test/Kex.html">Net::SSH::Test::Kex</a></li>
        
          <li><a href="../../../Net/SSH/Test/LocalPacket.html">Net::SSH::Test::LocalPacket</a></li>
        
          <li><a href="../../../Net/SSH/Test/Packet.html">Net::SSH::Test::Packet</a></li>
        
          <li><a href="../../../Net/SSH/Test/RemotePacket.html">Net::SSH::Test::RemotePacket</a></li>
        
          <li><a href="../../../Net/SSH/Test/Script.html">Net::SSH::Test::Script</a></li>
        
          <li><a href="../../../Net/SSH/Test/Socket.html">Net::SSH::Test::Socket</a></li>
        
          <li><a href="../../../Net/SSH/Transport.html">Net::SSH::Transport</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Algorithms.html">Net::SSH::Transport::Algorithms</a></li>
        
          <li><a href="../../../Net/SSH/Transport/CTR.html">Net::SSH::Transport::CTR</a></li>
        
          <li><a href="../../../Net/SSH/Transport/CipherFactory.html">Net::SSH::Transport::CipherFactory</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Constants.html">Net::SSH::Transport::Constants</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC.html">Net::SSH::Transport::HMAC</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/Abstract.html">Net::SSH::Transport::HMAC::Abstract</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/MD5.html">Net::SSH::Transport::HMAC::MD5</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/MD5_96.html">Net::SSH::Transport::HMAC::MD5_96</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/None.html">Net::SSH::Transport::HMAC::None</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/RIPEMD160.html">Net::SSH::Transport::HMAC::RIPEMD160</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/SHA1.html">Net::SSH::Transport::HMAC::SHA1</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/SHA1_96.html">Net::SSH::Transport::HMAC::SHA1_96</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/SHA2_256.html">Net::SSH::Transport::HMAC::SHA2_256</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/SHA2_256_96.html">Net::SSH::Transport::HMAC::SHA2_256_96</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/SHA2_512.html">Net::SSH::Transport::HMAC::SHA2_512</a></li>
        
          <li><a href="../../../Net/SSH/Transport/HMAC/SHA2_512_96.html">Net::SSH::Transport::HMAC::SHA2_512_96</a></li>
        
          <li><a href="../../../Net/SSH/Transport/IdentityCipher.html">Net::SSH::Transport::IdentityCipher</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Kex.html">Net::SSH::Transport::Kex</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Kex/DiffieHellmanGroup14SHA1.html">Net::SSH::Transport::Kex::DiffieHellmanGroup14SHA1</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Kex/DiffieHellmanGroup1SHA1.html">Net::SSH::Transport::Kex::DiffieHellmanGroup1SHA1</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Kex/DiffieHellmanGroupExchangeSHA1.html">Net::SSH::Transport::Kex::DiffieHellmanGroupExchangeSHA1</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Kex/DiffieHellmanGroupExchangeSHA256.html">Net::SSH::Transport::Kex::DiffieHellmanGroupExchangeSHA256</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Kex/EcdhSHA2NistP256.html">Net::SSH::Transport::Kex::EcdhSHA2NistP256</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Kex/EcdhSHA2NistP384.html">Net::SSH::Transport::Kex::EcdhSHA2NistP384</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Kex/EcdhSHA2NistP521.html">Net::SSH::Transport::Kex::EcdhSHA2NistP521</a></li>
        
          <li><a href="../../../Net/SSH/Transport/KeyExpander.html">Net::SSH::Transport::KeyExpander</a></li>
        
          <li><a href="../../../Net/SSH/Transport/PacketStream.html">Net::SSH::Transport::PacketStream</a></li>
        
          <li><a href="../../../Net/SSH/Transport/ServerVersion.html">Net::SSH::Transport::ServerVersion</a></li>
        
          <li><a href="../../../Net/SSH/Transport/Session.html">Net::SSH::Transport::Session</a></li>
        
          <li><a href="../../../Net/SSH/Transport/State.html">Net::SSH::Transport::State</a></li>
        
          <li><a href="../../../Net/SSH/Verifiers.html">Net::SSH::Verifiers</a></li>
        
          <li><a href="../../../Net/SSH/Verifiers/Lenient.html">Net::SSH::Verifiers::Lenient</a></li>
        
          <li><a href="../../../Net/SSH/Verifiers/Null.html">Net::SSH::Verifiers::Null</a></li>
        
          <li><a href="../../../Net/SSH/Verifiers/Secure.html">Net::SSH::Verifiers::Secure</a></li>
        
          <li><a href="../../../Net/SSH/Verifiers/Strict.html">Net::SSH::Verifiers::Strict</a></li>
        
          <li><a href="../../../Net/SSH/Version.html">Net::SSH::Version</a></li>
        
          <li><a href="../../../OpenSSL.html">OpenSSL</a></li>
        
          <li><a href="../../../OpenSSL/BN.html">OpenSSL::BN</a></li>
        
          <li><a href="../../../OpenSSL/PKey.html">OpenSSL::PKey</a></li>
        
          <li><a href="../../../OpenSSL/PKey/DH.html">OpenSSL::PKey::DH</a></li>
        
          <li><a href="../../../OpenSSL/PKey/DSA.html">OpenSSL::PKey::DSA</a></li>
        
          <li><a href="../../../OpenSSL/PKey/EC.html">OpenSSL::PKey::EC</a></li>
        
          <li><a href="../../../OpenSSL/PKey/OpenSSL.html">OpenSSL::PKey::OpenSSL</a></li>
        
          <li><a href="../../../OpenSSL/PKey/OpenSSL/PKey.html">OpenSSL::PKey::OpenSSL::PKey</a></li>
        
          <li><a href="../../../OpenSSL/PKey/OpenSSL/PKey/OpenSSL.html">OpenSSL::PKey::OpenSSL::PKey::OpenSSL</a></li>
        
          <li><a href="../../../OpenSSL/PKey/OpenSSL/PKey/OpenSSL/PKey.html">OpenSSL::PKey::OpenSSL::PKey::OpenSSL::PKey</a></li>
        
          <li><a href="../../../OpenSSL/PKey/OpenSSL/PKey/OpenSSL/PKey/ECError.html">OpenSSL::PKey::OpenSSL::PKey::OpenSSL::PKey::ECError</a></li>
        
          <li><a href="../../../OpenSSL/PKey/PKey.html">OpenSSL::PKey::PKey</a></li>
        
          <li><a href="../../../OpenSSL/PKey/RSA.html">OpenSSL::PKey::RSA</a></li>
        
          <li><a href="../../../String.html">String</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Net::SSH::Authentication::KeyManager</h1>

    <div id="description" class="description">
      
<p>This class encapsulates all operations done by clients on a user’s private
keys. In practice, the client should never need a reference to a private
key; instead, they grab a list of “identities” (public  keys) that are
available from the <a href="KeyManager.html">KeyManager</a>, and then use
the <a href="KeyManager.html">KeyManager</a> to do various private key
operations using those identities.</p>

<p>The <a href="KeyManager.html">KeyManager</a> also uses the <a
href="Agent.html">Agent</a> class to encapsulate the ssh-<a
href="KeyManager.html#method-i-agent">agent</a>. Thus, from a client’s
perspective it is completely hidden whether an identity comes from the
ssh-<a href="KeyManager.html#method-i-agent">agent</a> or from a file on
disk.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="key_data-attribute-method" class="method-detail">
          <a name="key_data"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">key_data</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>The list of user key data that will be examined</p>
          
          </div>
        </div>
        
        <div id="key_files-attribute-method" class="method-detail">
          <a name="key_files"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">key_files</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>The list of user key files that will be examined</p>
          
          </div>
        </div>
        
        <div id="known_identities-attribute-method" class="method-detail">
          <a name="known_identities"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">known_identities</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>The map of loaded identities</p>
          
          </div>
        </div>
        
        <div id="options-attribute-method" class="method-detail">
          <a name="options"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">options</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>The map of <a href="KeyManager.html#attribute-i-options">options</a> that
were passed to the key-manager</p>
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(logger, options={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Create a <a href="KeyManager.html#method-c-new">new</a> <a
href="KeyManager.html">KeyManager</a>. By default, the manager will use the
ssh-<a href="KeyManager.html#method-i-agent">agent</a> (if it is running).</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 41</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">logger</span>, <span class="ruby-identifier">options</span>={})
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">logger</span>
  <span class="ruby-ivar">@key_files</span> = []
  <span class="ruby-ivar">@key_data</span> = []
  <span class="ruby-ivar">@use_agent</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@known_identities</span> = {}
  <span class="ruby-ivar">@agent</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="add-method" class="method-detail ">
          <a name="method-i-add"></a>

          
          <div class="method-heading">
            <span class="method-name">add</span><span
              class="method-args">(key_file)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Add the given key_file to the list of key files that will be used.</p>
            

            
            <div class="method-source-code" id="add-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add</span>(<span class="ruby-identifier">key_file</span>)
  <span class="ruby-identifier">key_files</span>.<span class="ruby-identifier">push</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">key_file</span>)).<span class="ruby-identifier">uniq!</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- add-source -->
            
          </div>

          

          
        </div><!-- add-method -->

      
        <div id="add_key_data-method" class="method-detail ">
          <a name="method-i-add_key_data"></a>

          
          <div class="method-heading">
            <span class="method-name">add_key_data</span><span
              class="method-args">(key_data_)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Add the given key_file to the list of keys that will be used.</p>
            

            
            <div class="method-source-code" id="add_key_data-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 69</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_key_data</span>(<span class="ruby-identifier">key_data_</span>)
  <span class="ruby-identifier">key_data</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">key_data_</span>).<span class="ruby-identifier">uniq!</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- add_key_data-source -->
            
          </div>

          

          
        </div><!-- add_key_data-method -->

      
        <div id="agent-method" class="method-detail ">
          <a name="method-i-agent"></a>

          
          <div class="method-heading">
            <span class="method-name">agent</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns an <a href="Agent.html">Agent</a> instance to use for communicating
with an <a href="../../SSH.html">SSH</a> <a
href="KeyManager.html#method-i-agent">agent</a> process. Returns nil if use
of an <a href="../../SSH.html">SSH</a> <a
href="KeyManager.html#method-i-agent">agent</a> has been disabled, or if
the <a href="KeyManager.html#method-i-agent">agent</a> is otherwise not
available.</p>
            

            
            <div class="method-source-code" id="agent-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 176</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">agent</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">use_agent?</span>
  <span class="ruby-ivar">@agent</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Agent</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-identifier">logger</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">AgentNotAvailable</span>
  <span class="ruby-ivar">@use_agent</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- agent-source -->
            
          </div>

          

          
        </div><!-- agent-method -->

      
        <div id="clear-21-method" class="method-detail ">
          <a name="method-i-clear-21"></a>

          
          <div class="method-heading">
            <span class="method-name">clear!</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Clear all knowledge of any loaded user keys. This also clears the list of
default identity files that are to be loaded, thus making it appropriate to
use if a client wishes to NOT use the default identity files.</p>
            

            
            <div class="method-source-code" id="clear-21-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clear!</span>
  <span class="ruby-identifier">key_files</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">key_data</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">known_identities</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- clear-21-source -->
            
          </div>

          

          
        </div><!-- clear-21-method -->

      
        <div id="each_identity-method" class="method-detail ">
          <a name="method-i-each_identity"></a>

          
          <div class="method-heading">
            <span class="method-name">each_identity</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Iterates over all available identities (public keys) known to this manager.
As it finds one, it will then yield it to the caller. The origin of the
identities may be from files on disk or from an ssh-<a
href="KeyManager.html#method-i-agent">agent</a>. Note that identities from
an ssh-<a href="KeyManager.html#method-i-agent">agent</a> are always listed
first in the array, with other identities coming after.</p>

<p>If key manager was created with :keys_only option, any identity from ssh-<a
href="KeyManager.html#method-i-agent">agent</a> will be ignored unless it
present in <a href="KeyManager.html#attribute-i-key_files">key_files</a> or
<a href="KeyManager.html#attribute-i-key_data">key_data</a>.</p>
            

            
            <div class="method-source-code" id="each_identity-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 97</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_identity</span>
  <span class="ruby-identifier">prepared_identities</span> = <span class="ruby-identifier">prepare_identities_from_files</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">prepare_identities_from_data</span>

  <span class="ruby-identifier">user_identities</span> = <span class="ruby-identifier">load_identities</span>(<span class="ruby-identifier">prepared_identities</span>, <span class="ruby-keyword">false</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">agent</span>
    <span class="ruby-identifier">agent</span>.<span class="ruby-identifier">identities</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">corresponding_user_identity</span> = <span class="ruby-identifier">user_identities</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">identity</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">identity</span>[<span class="ruby-value">:public_key</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">identity</span>[<span class="ruby-value">:public_key</span>].<span class="ruby-identifier">to_pem</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_pem</span>
      }
      <span class="ruby-identifier">user_identities</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">corresponding_user_identity</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">corresponding_user_identity</span>

      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">options</span>[<span class="ruby-value">:keys_only</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">corresponding_user_identity</span>
        <span class="ruby-identifier">known_identities</span>[<span class="ruby-identifier">key</span>] = { <span class="ruby-value">:from</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:agent</span> }
        <span class="ruby-keyword">yield</span> <span class="ruby-identifier">key</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">user_identities</span> = <span class="ruby-identifier">load_identities</span>(<span class="ruby-identifier">user_identities</span>, <span class="ruby-keyword">true</span>)

  <span class="ruby-identifier">user_identities</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">identity</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-identifier">identity</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:public_key</span>)
    <span class="ruby-identifier">known_identities</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">identity</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">key</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- each_identity-source -->
            
          </div>

          

          
        </div><!-- each_identity-method -->

      
        <div id="finish-method" class="method-detail ">
          <a name="method-i-finish"></a>

          
          <div class="method-heading">
            <span class="method-name">finish</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>This is used as a hint to the <a href="KeyManager.html">KeyManager</a>
indicating that the <a href="KeyManager.html#method-i-agent">agent</a>
connection is no longer needed. Any other open resources may be closed at
this time.</p>

<p>Calling this does NOT indicate that the <a
href="KeyManager.html">KeyManager</a> will no longer be used. Identities
may still be requested and operations done on loaded identities, in which
case, the <a href="KeyManager.html#method-i-agent">agent</a> will be
automatically reconnected. This method simply allows the client connection
to be closed when it will not be used in the immediate future.</p>
            

            
            <div class="method-source-code" id="finish-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 83</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">finish</span>
  <span class="ruby-ivar">@agent</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@agent</span>
  <span class="ruby-ivar">@agent</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- finish-source -->
            
          </div>

          

          
        </div><!-- finish-method -->

      
        <div id="sign-method" class="method-detail ">
          <a name="method-i-sign"></a>

          
          <div class="method-heading">
            <span class="method-name">sign</span><span
              class="method-args">(identity, data)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sign the given data, using the corresponding private key of the given
identity. If the identity was originally obtained from an ssh-<a
href="KeyManager.html#method-i-agent">agent</a>, then the ssh-<a
href="KeyManager.html#method-i-agent">agent</a> will be used to <a
href="KeyManager.html#method-i-sign">sign</a> the data, otherwise the
private key for the identity will be loaded from disk (if it hasn’t been
loaded already) and will then be used to <a
href="KeyManager.html#method-i-sign">sign</a> the data.</p>

<p>Regardless of the identity’s origin or who does the signing, this will
always return the signature in an SSH2-specified “signature blob” format.</p>
            

            
            <div class="method-source-code" id="sign-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 136</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sign</span>(<span class="ruby-identifier">identity</span>, <span class="ruby-identifier">data</span>)
  <span class="ruby-identifier">info</span> = <span class="ruby-identifier">known_identities</span>[<span class="ruby-identifier">identity</span>] <span class="ruby-keyword">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">KeyManagerError</span>, <span class="ruby-string">&quot;the given identity is unknown to the key manager&quot;</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:key</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:from</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:file</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">info</span>[<span class="ruby-value">:key</span>] = <span class="ruby-constant">KeyFactory</span>.<span class="ruby-identifier">load_private_key</span>(<span class="ruby-identifier">info</span>[<span class="ruby-value">:file</span>], <span class="ruby-identifier">options</span>[<span class="ruby-value">:passphrase</span>], <span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span>, <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">OpenSSLError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span> 
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">KeyManagerError</span>, <span class="ruby-node">&quot;the given identity is known, but the private key could not be loaded: #{e.class} (#{e.message})&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:key</span>]
    <span class="ruby-keyword">return</span> <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">SSH</span><span class="ruby-operator">::</span><span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">:string</span>, <span class="ruby-identifier">identity</span>.<span class="ruby-identifier">ssh_type</span>,
      <span class="ruby-value">:string</span>, <span class="ruby-identifier">info</span>[<span class="ruby-value">:key</span>].<span class="ruby-identifier">ssh_do_sign</span>(<span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span>)).<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:from</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:agent</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">KeyManagerError</span>, <span class="ruby-string">&quot;the agent is no longer available&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">agent</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">agent</span>.<span class="ruby-identifier">sign</span>(<span class="ruby-identifier">identity</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">KeyManagerError</span>, <span class="ruby-node">&quot;[BUG] can't determine identity origin (#{info.inspect})&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- sign-source -->
            
          </div>

          

          
        </div><!-- sign-method -->

      
        <div id="use_agent-3D-method" class="method-detail ">
          <a name="method-i-use_agent-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">use_agent=</span><span
              class="method-args">(use_agent)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Toggles whether the ssh-<a href="KeyManager.html#method-i-agent">agent</a>
will be used or not. If true, an attempt will be made to use the ssh-<a
href="KeyManager.html#method-i-agent">agent</a>. If false, any existing
connection to an <a href="KeyManager.html#method-i-agent">agent</a> is
closed and the <a href="KeyManager.html#method-i-agent">agent</a> will not
be used.</p>
            

            
            <div class="method-source-code" id="use_agent-3D-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 168</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">use_agent=</span>(<span class="ruby-identifier">use_agent</span>)
  <span class="ruby-identifier">finish</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">use_agent</span>
  <span class="ruby-ivar">@use_agent</span> = <span class="ruby-identifier">use_agent</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- use_agent-3D-source -->
            
          </div>

          

          
        </div><!-- use_agent-3D-method -->

      
        <div id="use_agent-3F-method" class="method-detail ">
          <a name="method-i-use_agent-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">use_agent?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Identifies whether the ssh-<a
href="KeyManager.html#method-i-agent">agent</a> will be used or not.</p>
            

            
            <div class="method-source-code" id="use_agent-3F-source">
<pre>
<span class="ruby-comment"># File lib/net/ssh/authentication/key_manager.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">use_agent?</span>
  <span class="ruby-ivar">@use_agent</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- use_agent-3F-source -->
            
          </div>

          

          
        </div><!-- use_agent-3F-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

